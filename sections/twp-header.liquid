{% style %}
.twp-announcement_bar {
  background-color: {{ section.settings.announcement_background }};
  color: {{ section.settings.announcement_text_color }};
}
.twp-header_wrapper {
  background-color: {{ section.settings.background }};
}
.header__icons svg path {
  fill: {{ section.settings.svg-fill }};
}
.twp-nav_item a {
  color: {{ section.settings.svg-fill }}; 
}
{% endstyle %}
<div class="twp-header">
  <div class="twp-announcement_bar">
    <div class="page-width">
      <p>{{section.settings.announcement_text}}</p>
    </div>
  </div>
  <div class="twp-header_wrapper">
    <div class="page-width twp-header-menu_wrapper">
      {% if section.settings.twp-logo %}
        <a href="{{ shop.url }}" class="twp-header_logo-link">
          <img
            src="{{ section.settings.twp-logo | img_url: 'master' }}"
            alt="{{ shop.name }}"
            width="{{ section.settings.twp-logo_width }}"
            height="fit-content"
            style="width:{{ section.settings.twp-logo_width }}px;"
          >
        </a>
      {% else %}
        {% if section.settings.twp-header_text != blank %}
          <h1 class="twp-shop_name">{{ section.settings.twp-header_text }}</h1>
        {% else %}
          <h1 class="twp-shop_name">{{ shop.name }}</h1>
        {% endif %}
      {% endif %}
    
      <ul class="twp-main_menu">
        {% for link in section.settings.menu.links %}
          <li class="twp-nav_item"><a href="{{ link.url }}">{{ link.title }}</a></li>
        {% endfor %}
      </ul>
    
      <div class="header__icons{% if section.settings.enable_country_selector or section.settings.enable_language_selector %} header__icons--localization header-localization{% endif %}">
        <div class="desktop-localization-wrapper">
          {%- if section.settings.enable_country_selector and localization.available_countries.size > 1 -%}
            <localization-form class="small-hide medium-hide" data-prevent-hide>
              {%- form 'localization', id: 'HeaderCountryForm', class: 'localization-form' -%}
                <div>
                  <h2 class="visually-hidden" id="HeaderCountryLabel">{{ 'localization.country_label' | t }}</h2>
                  {%- render 'country-localization', localPosition: 'HeaderCountry' -%}
                </div>
              {%- endform -%}
            </localization-form>
          {% endif %}
    
          {%- if section.settings.enable_language_selector and localization.available_languages.size > 1 -%}
            <localization-form class="small-hide medium-hide" data-prevent-hide>
              {%- form 'localization', id: 'HeaderLanguageForm', class: 'localization-form' -%}
                <div>
                  <h2 class="visually-hidden" id="HeaderLanguageLabel">{{ 'localization.language_label' | t }}</h2>
                  {%- render 'language-localization', localPosition: 'HeaderLanguage' -%}
                </div>
              {%- endform -%}
            </localization-form>
          {%- endif -%}
        </div>
        {% render 'header-search', input_id: 'Search-In-Modal' %}
    
        {%- if shop.customer_accounts_enabled -%}
          <a
            href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}"
            class="header__icon header__icon--account link focus-inset{% if section.settings.menu != blank %} small-hide{% endif %}"
            rel="nofollow"
          >
            {%- if section.settings.enable_customer_avatar -%}
              <account-icon>
                {%- if customer and customer.has_avatar? -%}
                  {{ customer | avatar }}
                {%- else -%}
                  <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
                {%- endif -%}
              </account-icon>
            {%- else -%}
              <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
            {%- endif -%}
            <span class="visually-hidden">
              {%- liquid
                if customer
                  echo 'customer.account_fallback' | t
                else
                  echo 'customer.log_in' | t
                endif
              -%}
            </span>
          </a>
        {%- endif -%}
    
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when '@app' -%}
              {% render block %}
          {%- endcase -%}
        {%- endfor -%}
    
        <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart link focus-inset" id="cart-icon-bubble">
            {% if cart == empty %}
              <span class="svg-wrapper">{{'icon-cart-empty.svg' | inline_asset_content }}</span>
            {% else %}
              <span class="svg-wrapper">{{'icon-cart.svg' | inline_asset_content }}</span>
            {% endif %}
          <span class="visually-hidden">{{ 'templates.cart.cart' | t }}</span>
          {%- if cart != empty -%}
            <div class="cart-count-bubble">
              {%- if cart.item_count < 100 -%}
                <span aria-hidden="true">{{ cart.item_count }}</span>
              {%- endif -%}
              <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
            </div>
          {%- endif -%}
        </a>
      </div>
    
    </div>
  </div>
</div>


{% schema %}
{
  "name": "TWP header",
  "tag": "header",
  "class": "twp-header",
  "settings": [
    {
      "type": "image_picker",
      "id": "twp-logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "twp-logo_width",
      "label": "Logo width",
      "default": 125,
      "min": 80,
      "max": 200,
      "step": 5
    },
    {
      "type": "text",
      "id": "twp-header_text",  
      "label": "Header text",
    },
    {
      "type": "color",
      "id": "background",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "svg-fill",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu"
    }
  ],
  "blocks": [
    {
      "type": "announcement_bar",
      "name": "Announcement Bar",
      "settings": [
        {
          "type": "text",
          "id": "announcement_text",
          "label": "Announcement Text",
          "default": "Free shipping on all orders over $50"
        },
        {
          "type": "color",
          "id": "announcement_background",
          "label": "Background Color",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "announcement_text_color",
          "label": "Text Color",
          "default": "#000000"
        }
      ]
    }
  ]
}
{% endschema %}

